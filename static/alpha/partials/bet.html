<div id="bet-fail-modal" class="modal fade">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <!-- <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button> -->
        <h4 class="modal-title">Ooops!</h4>
      </div>
      <div class="modal-body">
        <p id="bet-fail-message"></p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<div ng-show="loaded">
    <div class="row bet-row">
        <dy-bet-list-item bet="bet"></dy-bet-list-item>
        <div><p>[[bet.description]]</p></div>
    </div>
    <h4 ng-if="bet.accepted_bid">Playing against</h4>
    <table class="table table-striped" ng-if="bet.accepted_bid">
        <tr>
            <td><dy-user-pic user="bet.accepted_bid.author"></dy-user-pic> <dy-user-name user="bet.accepted_bid.author"></dy-user-name></td>
            <td>[[bet.accepted_bid.title]]</td>
            <td>for [[bet.accepted_bid.amount]] coins</td>
        </tr>
    </table>
    <div ng-if="bet.bet_state=='bidding'">
        <h4 ng-if="bet.bet_type==1">This bet is open, it can be accepted until <time relative datetime="[[bet.bidding_deadline]]"></time></h4>
        <h4 ng-if="bet.bet_type==2">This bet is open, bids can be posted until <time relative datetime="[[bet.bidding_deadline]]"></time></h4>
        <div ng-if="bet.author.id!=user.id">
            <div class="row" ng-if="bet.bet_type==1">
                <div class="col-md-12">
                    <button type="button" class="btn btn-primary btn-lg btn-block" ng-click="acceptBet()">Bet against for [[bet.amount*bet.odds - bet.amount]] coins!</button>
                </div>
            </div>
            <div class="row" ng-if="bet.bet_type==2">
                <div class="col-md-12">
                    <div class="row">
                        <label class="col-sm-2">Bid</label>
                        <div class="col-sm-10"><input type="text" id="bidTitle" name="bidTitle" class="form-control" placeholder="I don't think so!" ng-model="bidTitle"></div>
                    </div>
                    <div class="row">
                        <label class="col-sm-2">For </label>
                        <div class="col-sm-3"><input type="number" id="bidAmount" name="bidAmount" class="form-control" value="10" ng-model="bidAmount"></div>
                        <span class="col-sm-2"> coins</span>
                        <span class="help-block"></span>
                        <button type="button" class="btn btn-primary btn-lg btn-block" ng-click="postBid(bidTitle, bidAmount)">Post Bid</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row" ng-if="bet.bet_state=='event'">
        <h4>This bet is closed, you'll be able to resolve it <time relative datetime="[[bet.event_deadline]]"></time></h4>
    </div>
    <div class="row" ng-if="bet.bet_state=='resolving'">
        <h4 ng-if="bet.author.id!=user.id">This bet is in resolving period, the author has 24 hours to resolve it.</h4>
        <div ng-if="bet.author.id==user.id">
            <h4>This bet is in resolving period, you have less than 24 hours to resolve it.</h4>
            <h3>Who has won this bet?</h3>
            <span class="col-md-4">
                <button type="button" class="btn btn-primary btn-block" ng-click="resolveBet(2, 'Ok... you got this one...')">[[bet.accepted_bid.author.username]]</button>
            </span>
            <span class="col-md-4">
                <button type="button" class="btn btn-primary btn-block" ng-click="resolveBet(3, '')">Nobody</button>
            </span>
            <span class="col-md-4">
                <button type="button" class="btn btn-primary btn-block" ng-click="resolveBet(1, 'I won!')">Me ([[bet.author.username]])</button>
            </span>
        </div>
    </div>
    <div class="row" ng-if="bet.bet_state=='complaining'">
        <h3 ng-if="bet.claim==1">[[bet.author.username]] claims he won this bet!</h3>
        <h3 ng-if="bet.claim==2">[[bet.author.username]] claims <span ng-if="user.id==bet.accepted_bid.author.id">you</span><span ng-if="user.id!=bet.accepted_bid.author.id">[[bet.accepted_bid.author.username]]</span> won this bet!</h3>
        <h3 ng-if="bet.claim==3">[[bet.author.username]] claims that this bet is null (nobody won).</h3>
        <p>[[bet.claim_message]]</p>
        <h4 ng-if="bet.accepted_bid.author.id!=user.id">This bet is in complaining period, the opponent has 24 hours to complain.</h4>
        <div ng-if="bet.accepted_bid.author.id==user.id">
            <h4>This bet is in complaining period, you have up to 24 hours to complain. If you don't complain we'll assume you're agree with [[bet.author.username]]'s claim.</h4>
            <div ng-show="!complaining">
                <h3>Are you agree with the resolution?</h3>
                <button type="button" class="btn btn-primary btn-block" ng-click="complainBet(bet.accepted_bid.id, bet.claim, '')">Yes</button>
                <button type="button" class="btn btn-primary btn-block" ng-click="complaining=true">No! I want to complain</button>
            </div>
            <div ng-show="complaining">
                <h3>Who has won this bet?</h3>
                <span class="col-md-4">
                    <button type="button" class="btn btn-primary btn-block" ng-click="complainBet(bet.accepted_bid.id, 1, 'You must be mistaken')">[[bet.author.username]]</button>
                </span>
                <span class="col-md-4">
                    <button type="button" class="btn btn-primary btn-block" ng-click="complainBet(bet.accepted_bid.id, 3, 'You must me mistaken')">Nobody</button>
                </span>
                <span class="col-md-4">
                    <button type="button" class="btn btn-primary btn-block" ng-click="complainBet(bet.accepted_bid.id, 2, 'You\'re fucking wrong! I won!')">Me ([[bet.accepted_bid.author.username]])</button>
                </span>
            </div>
        </div>
    </div>
    <div class="row" ng-if="bet.bet_state=='arbitrating'">
        <h4>This bet is under conflict!</h4>
        <h3 ng-if="bet.claim==1">[[bet.author.username]] claims he won this bet!</h3>
        <h3 ng-if="bet.claim==2">[[bet.author.username]] claims <span ng-if="user.id==bet.accepted_bid.author.id">you</span><span ng-if="user.id!=bet.accepted_bid.author.id">[[bet.accepted_bid.author.username]]</span> won this bet!</h3>
        <h3 ng-if="bet.claim==3">[[bet.author.username]] claims that this bet is null (nobody won).</h3>
        <p>[[bet.claim_message]]</p>
        <h3 ng-if="bet.accepted_bid.claim==1">[[bet.accepted_bid.author.username]] claims <span ng-if="user.id==bet.author.id">you</span><span ng-if="user.id!=bet.author.id">[[bet.author.username]]</span> won this bet!</h3>
        <h3 ng-if="bet.accepted_bid.claim==2">[[bet.accepted_bid.author.username]] claims he won this bet!</h3>
        <h3 ng-if="bet.accepted_bid.claim==3">[[bet.accepted_bid.author.username]] claims that this bet is null (nobody won).</h3>
        <p>[[bet.accepted_bid.claim_message]]</p>
        <div ng-if="bet.accepted_bid.author.id!=user.id && bet.author.id!=user.id">
            <h4>Arbitrate this bet and you'll get [[bet.referee_escrow]] coins and some extra points!.</h4>
            <h3>Who has won this bet?</h3>
            <span class="col-md-4">
                <button type="button" class="btn btn-primary btn-block" ng-click="arbitrateBet(1, '')">[[bet.author.username]]</button>
            </span>
            <span class="col-md-4">
                <button type="button" class="btn btn-primary btn-block" ng-click="arbitrateBet(3, '')">Nobody</button>
            </span>
            <span class="col-md-4">
                <button type="button" class="btn btn-primary btn-block" ng-click="arbitrateBet(2, '')">[[bet.accepted_bid.author.username]]</button>
            </span>
        </div>
    </div>
    <div class="row" ng-if="bet.bet_state=='closed'">
        <div class="alert alert-info">This bet is finished. 
            <span ng-if="bet.winners"><dy-user-name user="bet.winners[0]" in-alert="true"></dy-user-name> won this bet.</span>
            <span ng-if="!bet.winners">Nobody won this bet.</span>
            <span ng-if="bet.referee"><dy-user-name user="bet.referee"></dy-user-name> arbitrated this bet.</span>
        </div>
    </div>
    <table class="table table-striped" style="margin-top:30px;">
        <tr ng-repeat="bid in bet.bids" ng-if="bid.id != bet.accepted_bid.id">
            <td><dy-user-pic user="bid.author" size="micro"></dy-user-pic> <dy-user-name user="bid.author"></dy-user-name></td>
            <td>[[bid.title]]</td>
            <td>for [[bid.amount]] coins</td>
            <td><span ng-if="bid.id == bet.accepted_bid.id" class="label label-success">ACCEPTED</span></td>
            <td><button id="[[bid.id]]" type="button" ng-if="user.id == bet.author.id && bet.bet_state=='bidding'" class="btn btn-primary btn-block" ng-click="acceptBid(bid.id)">Accept Bid</button></td>
            <td><button id="[[bid.id]]" type="button" ng-if="user.id == bet.author.id && bet.bet_state=='bidding'" class="close" aria-hidden="true" ng-click="removeBid(bid.id)">&times;</button></td>
        </tr>
    </table>
</div>